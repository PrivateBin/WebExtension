var gdr_gdr_name_pubkey = "-----BEGIN PGP PUBLIC KEY BLOCK-----\nVersion: GnuPG v1\n\n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\ns8iJag==\n=OTHW\n-----END PGP PUBLIC KEY BLOCK-----\n";


/* TODO this is obviously a crappy algorithm for detecting PrivateBin */
if (document.title == "PrivateBin") {
    console.log("PrivateBin validator reporting for duty!");

    /*
     * Given: 
     * HTMLCollection elements containing <script> elements and \
     * Object versionHashes containing a map of expected filename => integrity mapping
     * return:
     * - true if all scripts match
     * - false if there is a non-matching script
     * - a string if there is another problem
     */
    var compareSignatures = function(elements, versionHashes) {
	var foundFiles = new Object();
	for (var i = 0; i < elements.length; i++) {
	    var element = elements[i];
	    var src = element.getAttribute("src");
	    var integrity = element.getAttribute("integrity"); 

	    if (src === null) {
		return "Found a rouge script tag without src";
	    }

	    if (integrity === null) {
		return "Found a script tag without integrity";
	    }

	    if (versionHashes[src] !== undefined) {
		if (versionHashes[src] != integrity) {
		    return false;
		} else {
		    foundFiles[src] = true;
		}
	    } else {
		return false;
	    }
	}

	/* All scripts on page match at this point, now check if no scripts are missing */
	for (var script_name in versionHashes) {
	    if (foundFiles[script_name] === undefined) {
		return script_name + " missing";
	    }
	}

	return true;
    };

    var checkScriptElements = function(hashes) {
	var scriptElements = document.getElementsByTagName("script");
	var found = false;
	for (var version_number in hashes) {
	    if (compareSignatures(scriptElements, hashes[version_number]) === true) {
		found = version_number;
		break;
	    }
	}
	if (found !== false) {
	    console.log("Found PrivateBin v" + found);
	} else {
	    console.log("PrivateBin did not match any version");
	    window.alert("It's not safe to use this PrivateBin instance, it may be serving malicious Javascript!");
	}
    };

    var getBrowser = function() {
	if (typeof browser !== "undefined") {
	    return browser;
	} else {
	    return chrome;
	}
    }

    var storageErrorHandler = function(error) {
	console.log("Fetching hashes via XHR");
	var xhr = new XMLHttpRequest();
	xhr.open('GET', "https://gdr.name/privatebin_hashes.json");
	xhr.responseType = 'text';
	xhr.onload = function(e) {
	    if (this.status == 200) {
		var jsonResponse = JSON.parse(this.response);
		/* TODO proper sanity check of the received file */
		/* TODO signature validation */
		if (typeof jsonResponse['hashes'] === 'undefined') {
		    console.log(jsonResponse);
		    window.alert("Received a fishy hashes file");
		    return;
		}

		getBrowser().storage.local.set({"privatebin": jsonResponse});
		checkScriptElements(jsonResponse['hashes']);
	    } else {
		window.alert("Could not retrieve hashes for PrivateBin");
	    }
	};
	xhr.send();
    };

    var storageRetrievedHandler = function(item) {
	if (item && Object.getOwnPropertyNames(item).length > 0 && !getBrowser().runtime.lastError) {
	    checkScriptElements(item['privatebin']['hashes']);
	} else {
	    storageErrorHandler(null);
	}
    };

    getBrowser().storage.local.get("privatebin", storageRetrievedHandler);
}
